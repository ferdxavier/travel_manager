# Definição das Operações para o recurso /vehicles/{id} (Recurso Singular)

parameters: # OBRIGATÓRIO: Define os parâmetros que são herdados por todas as operações
  # SUBSTITUÍDO: Usando a referência reutilizável para o ID no PATH.
  - $ref: "../../common/parameters.yaml#/ResourceIdPath"

get:
  summary: "Recupera os detalhes de um veículo específico."
  description: "Retorna a representação completa de um veículo pelo seu ID único."
  operationId: getVehicleById
  tags:
    - Vehicles

  # Esta rota requer autenticação para consultar dados
  security:
    - BearerAuth: []

  responses:
    "200":
      description: "Detalhes do veículo recuperado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/vehicle.yaml#/Vehicle" 

    # Tratamento de Erros
    "401":
      description: "Não autorizado. Token de autenticação ausente ou inválido."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "403":
      description: "Proibido. O usuário está autenticado, mas não tem permissão de leitura para este veículo."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "404":
      description: "Veículo não encontrado pelo ID fornecido."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "500":
      description: "Erro interno do servidor."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    default:
      description: "Erro inesperado não mapeado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"


put:
  summary: "Substitui completamente um registo de veículo."
  description: "Substitui o registo completo do veículo pelo ID. Requer todos os campos obrigatórios."
  operationId: replaceVehicle
  tags:
    - Vehicles
    
  security:
    - BearerAuth: []

  requestBody:
    description: "O objeto CreateVehicleRequest completo para substituir o recurso."
    required: true
    content:
      application/json:
        schema:
          # PUT usa o DTO de Criação para forçar todos os campos
          $ref: "../../schemas/vehicle.yaml#/CreateVehicleRequest" 

  responses:
    "200":
      description: "Veículo substituído com sucesso."
      content:
        application/json:
          schema:
            $ref: "../../schemas/vehicle.yaml#/Vehicle"

    # Tratamento de Erros
    "400":
      description: "Requisição inválida. Erro de validação de dados."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "401":
      description: "Não autorizado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"
            
    "403":
      description: "Proibido. O usuário não tem permissão para alterar este recurso."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "404":
      description: "Veículo não encontrado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "409":
      description: "Conflito. (Ex: A nova placa já está em uso por outro veículo)."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "500":
      description: "Erro interno do servidor."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    default:
      description: "Erro ao substituir o veículo."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"


patch:
  summary: "Atualiza parcialmente os detalhes de um veículo."
  description: "Permite atualizar um ou mais campos do veículo sem enviar o objeto completo (Partial Update)."
  operationId: updateVehicle
  tags:
    - Vehicles
    
  security:
    - BearerAuth: []

  requestBody:
    description: "O objeto UpdateVehicleRequest com os campos a serem modificados."
    required: true
    content:
      application/json:
        schema:
          # PATCH usa o DTO de Atualização Parcial
          $ref: "../../schemas/vehicle.yaml#/UpdateVehicleRequest" 

  responses:
    "200":
      description: "Veículo atualizado com sucesso. Retorna o objeto atualizado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/vehicle.yaml#/Vehicle"

    # Tratamento de Erros
    "400":
      description: "Requisição inválida. Erro de validação de dados."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "401":
      description: "Não autorizado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"
            
    "403":
      description: "Proibido. O usuário não tem permissão para modificar este recurso."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "404":
      description: "Veículo não encontrado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "409":
      description: "Conflito. (Ex: A nova placa já está em uso por outro veículo)."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "500":
      description: "Erro interno do servidor."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    default:
      description: "Erro ao atualizar o veículo."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"


delete:
  summary: "Remove um veículo da frota."
  description: "Remove permanentemente (ou logicamente desativa) um veículo pelo seu ID."
  operationId: deleteVehicle
  tags:
    - Vehicles
    
  security:
    - BearerAuth: []

  responses:
    "204":
      description: "Veículo removido com sucesso (Sem conteúdo)."
    
    # Tratamento de Erros
    "401":
      description: "Não autorizado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"
            
    "403":
      description: "Proibido. O usuário não tem permissão para remover este recurso."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "404":
      description: "Veículo não encontrado."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    "500":
      description: "Erro interno do servidor."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"

    default:
      description: "Erro ao remover o veículo."
      content:
        application/json:
          schema:
            $ref: "../../schemas/common_error.yaml#/ErrorResponse"